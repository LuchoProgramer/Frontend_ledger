(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,s)=>{t.exports=e.r(76562)},62512,e=>{"use strict";var t=e.i(18050),s=e.i(71645),a=e.i(18566),r=e.i(9165);function l(){let e=(0,a.useRouter)(),[l,i]=(0,s.useState)([]),[d,n]=(0,s.useState)(!1),[o,c]=(0,s.useState)(""),[x,g]=(0,s.useState)(""),[u,m]=(0,s.useState)(""),[b,h]=(0,s.useState)(1),[p,y]=(0,s.useState)(1),N=(0,r.getApiClient)(),j=async()=>{n(!0);try{let e=await N.getHistorialVentas({page:b,start_date:o,end_date:x,search:u});i(e.results),e.count&&y(Math.ceil(e.count/20))}catch(e){console.error("Error cargando facturas",e)}finally{n(!1)}};return(0,s.useEffect)(()=>{let e=setTimeout(()=>{j()},500);return()=>clearTimeout(e)},[b,o,x,u]),(0,s.useEffect)(()=>{if(!l.some(e=>"PPR"===e.estado_sri))return;let e=setInterval(()=>{j()},1e4);return()=>clearTimeout(e)},[l]),(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm border-b mb-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("button",{onClick:()=>e.push("/"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:"â†"}),(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Mis Ventas"})]}),(0,t.jsx)("button",{onClick:()=>j(),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Actualizar",children:"ðŸ”„"})]})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 pb-8",children:[(0,t.jsx)("div",{className:"bg-white p-4 rounded-xl shadow-sm mb-6 border border-gray-100",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"Buscar cliente o nÃºmero...",value:u,onChange:e=>{m(e.target.value),h(1)},className:"w-full p-2.5 border border-gray-300 rounded-lg"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsx)("input",{type:"date",value:o,onChange:e=>{c(e.target.value),h(1)},className:"w-full p-2.5 border border-gray-300 rounded-lg text-sm"}),(0,t.jsx)("input",{type:"date",value:x,onChange:e=>{g(e.target.value),h(1)},className:"w-full p-2.5 border border-gray-300 rounded-lg text-sm"})]})]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[d&&(0,t.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-sm text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-2 text-gray-500",children:"Cargando ventas..."})]}),!d&&0===l.length&&(0,t.jsx)("div",{className:"bg-white p-8 rounded-xl shadow-sm text-center text-gray-500",children:"No se encontraron ventas recientes."}),l.map(e=>{let s;return(0,t.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-bold text-gray-900",children:e.numero_autorizacion}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.fecha_emision).toLocaleString("es-EC")})]}),(s=({AUT:{bg:"bg-green-100",text:"text-green-800",label:"AUTORIZADO"},PPR:{bg:"bg-yellow-100",text:"text-yellow-800",label:"PROCESANDO"},NAT:{bg:"bg-red-100",text:"text-red-800",label:"NO AUTORIZADO"},DEV:{bg:"bg-orange-100",text:"text-orange-800",label:"DEVUELTA"}})[e.estado_sri||"PENDIENTE"]||{bg:"bg-gray-100",text:"text-gray-800",label:"PENDIENTE"},(0,t.jsx)("span",{className:`px-2.5 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${s.bg} ${s.text}`,children:s.label}))]}),(0,t.jsxs)("div",{className:"mb-3 pl-2 border-l-2 border-gray-200",children:[(0,t.jsx)("div",{className:"text-sm text-gray-800",children:e.cliente_nombre}),(0,t.jsxs)("div",{className:"text-lg font-bold text-indigo-900 mt-1",children:["$",Number(e.total_con_impuestos).toFixed(2)]})]}),(0,t.jsx)("div",{className:"flex gap-2 pt-3 border-t border-gray-50",children:(0,t.jsxs)("button",{onClick:async()=>{try{await N.descargarFacturaPDF(e.id,e.numero_autorizacion)}catch(e){alert("Error descargando PDF")}},className:"flex-1 py-2 bg-indigo-50 text-indigo-700 font-medium rounded-lg hover:bg-indigo-100 flex items-center justify-center gap-2",children:[(0,t.jsx)("span",{children:"ðŸ“„"})," Descargar RIDE"]})})]},e.id)})]}),(0,t.jsxs)("div",{className:"flex justify-center gap-4 mt-8",children:[(0,t.jsx)("button",{disabled:b<=1,onClick:()=>h(e=>e-1),className:"px-4 py-2 bg-white border rounded-lg disabled:opacity-50",children:"Anterior"}),(0,t.jsxs)("span",{className:"py-2 text-gray-600",children:["PÃ¡g ",b," de ",p]}),(0,t.jsx)("button",{disabled:b>=p,onClick:()=>h(e=>e+1),className:"px-4 py-2 bg-white border rounded-lg disabled:opacity-50",children:"Siguiente"})]})]})]})}e.s(["default",()=>l])}]);