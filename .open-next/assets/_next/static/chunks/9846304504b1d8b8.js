(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15788,e=>{"use strict";let t=(0,e.i(75254).default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["Truck",()=>t],15788)},18566,(e,t,s)=>{t.exports=e.r(76562)},75254,e=>{"use strict";var t=e.i(71645);let s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim();var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let r=(0,t.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:n="",children:d,iconNode:o,...c},x)=>(0,t.createElement)("svg",{ref:x,...l,width:s,height:s,stroke:e,strokeWidth:i?24*Number(r)/Number(s):r,className:a("lucide",n),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...o.map(([e,s])=>(0,t.createElement)(e,s)),...Array.isArray(d)?d:[d]])),i=(e,l)=>{let i=(0,t.forwardRef)(({className:i,...n},d)=>(0,t.createElement)(r,{ref:d,iconNode:l,className:a(`lucide-${s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...n}));return i.displayName=s(e),i};e.s(["default",()=>i],75254)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},84975,e=>{"use strict";var t=e.i(18050),s=e.i(71645),a=e.i(18566),l=e.i(83639),r=e.i(9165);function i(){let e=(0,a.useRouter)(),i=(0,r.getApiClient)(),[n,d]=(0,s.useState)(""),[o,c]=(0,s.useState)(null),[x,u]=(0,s.useState)("01"),[m,h]=(0,s.useState)(""),[p,g]=(0,s.useState)(""),[b,j]=(0,s.useState)(""),[v,N]=(0,s.useState)(""),[f,y]=(0,s.useState)("1"),[w,C]=(0,s.useState)("312"),[k,S]=(0,s.useState)(""),[R,_]=(0,s.useState)("1.75"),[A,E]=(0,s.useState)([]),[F,T]=(0,s.useState)(!1),I=async()=>{try{let e=await i.getProveedores({search:n});e.results&&e.results.length>0?c(e.results[0]):(alert("Proveedor no encontrado. (Asegúrese de que esté registrado como Proveedor/Cliente)"),c(null))}catch(e){console.error(e)}},B=async()=>{if(!o)return void alert("Seleccione un proveedor");if(0===A.length)return void alert("Agregue al menos un impuesto a retener");T(!0);try{await i.crearRetencion({proveedor:{id:o.id},documento_sustento:{tipo_documento:x,numero_documento:m,fecha_emision:p,base_imponible_total:parseFloat(b),total_documento:parseFloat(v)},impuestos:A}),alert("Retención generada exitosamente"),e.push("/facturacion/retenciones")}catch(e){alert(e.error||"Error al crear retención")}finally{T(!1)}};return(0,t.jsx)(l.default,{children:(0,t.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Nueva Retención"}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded shadow-sm mb-6",children:[(0,t.jsx)("h2",{className:"text-lg font-bold mb-4 border-b pb-2",children:"1. Proveedor / Sujeto Retenido"}),(0,t.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"RUC / Cédula"}),(0,t.jsx)("input",{type:"text",className:"w-full p-2 border rounded",value:n,onChange:e=>d(e.target.value),placeholder:"Ingrese identificación"})]}),(0,t.jsx)("button",{onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Buscar"})]}),o&&(0,t.jsxs)("div",{className:"mt-4 p-4 bg-green-50 rounded text-green-800",children:[(0,t.jsx)("strong",{children:"Seleccionado:"})," ",o.razon_social," (",o.identificacion,")"]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded shadow-sm mb-6",children:[(0,t.jsx)("h2",{className:"text-lg font-bold mb-4 border-b pb-2",children:"2. Documento Sustento"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo Documento"}),(0,t.jsxs)("select",{className:"w-full p-2 border rounded",value:x,onChange:e=>u(e.target.value),children:[(0,t.jsx)("option",{value:"01",children:"Factura"}),(0,t.jsx)("option",{value:"03",children:"Liquidación de Compra"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Número (001-001-123456789)"}),(0,t.jsx)("input",{type:"text",className:"w-full p-2 border rounded",value:m,onChange:e=>h(e.target.value),placeholder:"001-001-000000001"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Fecha Emisión"}),(0,t.jsx)("input",{type:"date",className:"w-full p-2 border rounded",value:p,onChange:e=>g(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Base Imponible Total"}),(0,t.jsx)("input",{type:"number",className:"w-full p-2 border rounded",value:b,onChange:e=>j(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Total Documento"}),(0,t.jsx)("input",{type:"number",className:"w-full p-2 border rounded",value:v,onChange:e=>N(e.target.value)})]})]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded shadow-sm mb-6",children:[(0,t.jsx)("h2",{className:"text-lg font-bold mb-4 border-b pb-2",children:"3. Impuestos a Retener"}),(0,t.jsx)("div",{className:"p-4 bg-gray-50 rounded mb-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-2 items-end",children:[(0,t.jsxs)("div",{className:"col-span-1",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:"Impuesto"}),(0,t.jsxs)("select",{className:"w-full p-1 border rounded text-sm",value:f,onChange:e=>y(e.target.value),children:[(0,t.jsx)("option",{value:"1",children:"RENTA"}),(0,t.jsx)("option",{value:"2",children:"IVA"})]})]}),(0,t.jsxs)("div",{className:"col-span-1",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:"Cód. Retención"}),(0,t.jsx)("input",{type:"text",className:"w-full p-1 border rounded text-sm",value:w,onChange:e=>C(e.target.value),placeholder:"Ej. 312"})]}),(0,t.jsxs)("div",{className:"col-span-1",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:"Base Imp."}),(0,t.jsx)("input",{type:"number",className:"w-full p-1 border rounded text-sm",value:k,onChange:e=>S(e.target.value),placeholder:"0.00"})]}),(0,t.jsxs)("div",{className:"col-span-1",children:[(0,t.jsx)("label",{className:"text-xs text-gray-500",children:"% Retener"}),(0,t.jsx)("input",{type:"number",className:"w-full p-1 border rounded text-sm",value:R,onChange:e=>_(e.target.value),placeholder:"%"})]}),(0,t.jsx)("button",{onClick:()=>{let e=parseFloat(k),t=parseFloat(R);if(!e||!t)return;let s=(e*t/100).toFixed(2);E([...A,{codigo_impuesto:f,codigo_retencion:w,base_imponible:e,porcentaje:t,valor_retenido:parseFloat(s)}]),S("")},className:"bg-green-600 text-white p-1 rounded hover:bg-green-700 text-sm",children:"Agregar"})]})}),(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"text-left text-xs text-gray-500",children:"Impuesto"}),(0,t.jsx)("th",{className:"text-left text-xs text-gray-500",children:"Código"}),(0,t.jsx)("th",{className:"text-right text-xs text-gray-500",children:"Base"}),(0,t.jsx)("th",{className:"text-right text-xs text-gray-500",children:"%"}),(0,t.jsx)("th",{className:"text-right text-xs text-gray-500",children:"Valor Retenido"}),(0,t.jsx)("th",{})]})}),(0,t.jsx)("tbody",{children:A.map((e,s)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"text-sm",children:"1"===e.codigo_impuesto?"RENTA":"IVA"}),(0,t.jsx)("td",{className:"text-sm",children:e.codigo_retencion}),(0,t.jsxs)("td",{className:"text-sm text-right",children:["$",e.base_imponible.toFixed(2)]}),(0,t.jsxs)("td",{className:"text-sm text-right",children:[e.porcentaje,"%"]}),(0,t.jsxs)("td",{className:"text-sm text-right font-bold",children:["$",e.valor_retenido.toFixed(2)]}),(0,t.jsx)("td",{className:"text-right",children:(0,t.jsx)("button",{onClick:()=>{let e;(e=[...A]).splice(s,1),E(e)},className:"text-red-500 text-xs",children:"Eliminar"})})]},s))}),(0,t.jsx)("tfoot",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{colSpan:4,className:"text-right font-bold pt-4",children:"Total Retenido:"}),(0,t.jsxs)("td",{className:"text-right font-bold pt-4 text-lg",children:["$",A.reduce((e,t)=>e+t.valor_retenido,0).toFixed(2)]}),(0,t.jsx)("td",{})]})})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,t.jsx)("button",{onClick:()=>e.back(),className:"px-4 py-2 border rounded text-gray-600",children:"Cancelar"}),(0,t.jsx)("button",{onClick:B,disabled:F,className:"px-6 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:opacity-50",children:F?"Emitiendo...":"Emitir Retención"})]})]})})}e.s(["default",()=>i])}]);