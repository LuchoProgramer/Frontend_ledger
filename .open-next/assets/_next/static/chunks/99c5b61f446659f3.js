(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15788,e=>{"use strict";let t=(0,e.i(75254).default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["Truck",()=>t],15788)},18566,(e,t,s)=>{t.exports=e.r(76562)},75254,e=>{"use strict";var t=e.i(71645);let s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim();var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:o="",children:n,iconNode:d,...c},x)=>(0,t.createElement)("svg",{ref:x,...r,width:s,height:s,stroke:e,strokeWidth:i?24*Number(l)/Number(s):l,className:a("lucide",o),...!n&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,s])=>(0,t.createElement)(e,s)),...Array.isArray(n)?n:[n]])),i=(e,r)=>{let i=(0,t.forwardRef)(({className:i,...o},n)=>(0,t.createElement)(l,{ref:n,iconNode:r,className:a(`lucide-${s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...o}));return i.displayName=s(e),i};e.s(["default",()=>i],75254)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},36786,e=>{"use strict";var t=e.i(18050),s=e.i(71645),a=e.i(74080);function r({children:e,isOpen:r,onClose:l}){let[i,o]=(0,s.useState)(!1);return((0,s.useEffect)(()=>(o(!0),()=>o(!1)),[]),(0,s.useEffect)(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[r]),i&&r)?(0,a.createPortal)((0,t.jsx)("div",{className:"fixed inset-0 z-[99999] overflow-y-auto",role:"dialog","aria-modal":"true",children:(0,t.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,t.jsx)("div",{className:"fixed inset-0 transition-opacity bg-gray-900/50 backdrop-blur-sm","aria-hidden":"true",onClick:l}),(0,t.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),(0,t.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full relative z-[10000]",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 pt-4 pr-4 block",children:(0,t.jsxs)("button",{type:"button",className:"bg-white rounded-md text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:l,children:[(0,t.jsx)("span",{className:"sr-only",children:"Cerrar"}),(0,t.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})]})}),e]})]})}),document.body):null}e.s(["default",()=>r])},42366,e=>{"use strict";var t=e.i(18050),s=e.i(71645),a=e.i(83639),r=e.i(9165),l=e.i(36786);function i({isOpen:e,onClose:a,onConfirm:r,systemTotals:i}){let[o,n]=(0,s.useState)({efectivo_total:0,tarjeta_total:0,transferencia_total:0,salidas_caja:0,observaciones:""}),[d,c]=(0,s.useState)(!1),x=(e,t)=>{"observaciones"===e?n(s=>({...s,[e]:t})):n(s=>({...s,[e]:parseFloat(t)||0}))},u=async()=>{if(confirm("Â¿EstÃ¡s seguro de cerrar el turno con estos valores? Esta acciÃ³n es irreversible.")){c(!0);try{await r(o),a()}catch(e){console.error(e)}finally{c(!1)}}};if(!e)return null;let m=o.efectivo_total+o.tarjeta_total+o.transferencia_total-o.salidas_caja;return(0,t.jsx)(l.default,{isOpen:e,onClose:a,children:(0,t.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 max-w-lg w-full rounded-lg shadow-xl",children:[(0,t.jsxs)("div",{className:"mb-6 border-b pb-4",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:"ðŸ”’ Cerrar Turno de Caja"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Por favor, ingrese los valores finales del arqueo fÃ­sico."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 w-1/3",children:"ðŸ’µ Efectivo Real"}),(0,t.jsxs)("div",{className:"w-2/3 relative",children:[(0,t.jsx)("span",{className:"absolute left-3 top-2 text-gray-400",children:"$"}),(0,t.jsx)("input",{type:"number",min:"0",step:"0.01",className:"pl-8 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border",placeholder:"0.00",value:o.efectivo_total||"",onChange:e=>x("efectivo_total",e.target.value)})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 w-1/3",children:"ðŸ’³ Tarjetas (Vouchers)"}),(0,t.jsxs)("div",{className:"w-2/3 relative",children:[(0,t.jsx)("span",{className:"absolute left-3 top-2 text-gray-400",children:"$"}),(0,t.jsx)("input",{type:"number",min:"0",step:"0.01",className:"pl-8 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border",placeholder:"0.00",value:o.tarjeta_total||"",onChange:e=>x("tarjeta_total",e.target.value)})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 w-1/3",children:"ðŸ¦ Transferencias"}),(0,t.jsxs)("div",{className:"w-2/3 relative",children:[(0,t.jsx)("span",{className:"absolute left-3 top-2 text-gray-400",children:"$"}),(0,t.jsx)("input",{type:"number",min:"0",step:"0.01",className:"pl-8 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border",placeholder:"0.00",value:o.transferencia_total||"",onChange:e=>x("transferencia_total",e.target.value)})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-red-700 w-1/3",children:"ðŸ“¤ Gastos / Retiros"}),(0,t.jsxs)("div",{className:"w-2/3 relative",children:[(0,t.jsx)("span",{className:"absolute left-3 top-2 text-red-400",children:"$"}),(0,t.jsx)("input",{type:"number",min:"0",step:"0.01",className:"pl-8 block w-full rounded-md border-red-300 text-red-900 placeholder-red-300 focus:border-red-500 focus:ring-red-500 sm:text-sm p-2 border bg-red-50",placeholder:"0.00",value:o.salidas_caja||"",onChange:e=>x("salidas_caja",e.target.value)})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[(0,t.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"Total Declarado:"}),(0,t.jsxs)("span",{className:"text-xl font-bold text-indigo-600",children:["$",m.toFixed(2)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observaciones / Novedades"}),(0,t.jsx)("textarea",{rows:3,className:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md border p-2",placeholder:"Ej: Faltante de $0.05 por redondeo...",value:o.observaciones,onChange:e=>x("observaciones",e.target.value)})]})]}),(0,t.jsxs)("div",{className:"mt-8 flex justify-end gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:a,disabled:d,className:"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancelar"}),(0,t.jsx)("button",{type:"button",onClick:u,disabled:d,className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:d?"Cerrando...":"Confirmar Cierre"})]})]})})}function o(){let[e,o]=(0,s.useState)(null),[n,d]=(0,s.useState)(!0),[c,x]=(0,s.useState)([]),[u,m]=(0,s.useState)([]),[b,h]=(0,s.useState)([]),[g,f]=(0,s.useState)({identificacion:"9999999999",razon_social:"CONSUMIDOR FINAL",email:"",direccion:""}),[p,j]=(0,s.useState)(""),[v,y]=(0,s.useState)(!1),[N,w]=(0,s.useState)(!1),[C,k]=(0,s.useState)("catalog"),[S,_]=(0,s.useState)(!1),[F,$]=(0,s.useState)(null),[E,T]=(0,s.useState)({message:"",visible:!1}),[P,A]=(0,s.useState)(!1),[z,O]=(0,s.useState)(!0),[D,R]=(0,s.useState)(!1),[I,M]=(0,s.useState)(""),[L,U]=(0,s.useState)([]),[V,B]=(0,s.useState)(!1),[W,q]=(0,s.useState)(!1),[G,H]=(0,s.useState)({tipo_identificacion:"05",identificacion:"",razon_social:"",email:"",direccion:"",telefono:""}),Z=(0,s.useRef)(null),K=(0,r.getApiClient)();(0,s.useEffect)(()=>{J()},[]),(0,s.useEffect)(()=>{let e=e=>{"F10"===e.key&&(e.preventDefault(),R(!0)),"F9"===e.key&&(e.preventDefault(),eN()),"F2"===e.key&&(e.preventDefault(),Z.current?.focus())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[b]);let J=async()=>{d(!0);try{let e=await K.verificarTurno();e.success&&e.activo&&e.data?(o(e.data),X("",e.data.sucursal)):(o(null),await Q(),_(!0))}catch(e){console.error("Error checking turno:",e)}finally{d(!1)}},Q=async()=>{try{let e=await K.getSucursales();e.success&&e.sucursales&&(x(e.sucursales),e.sucursales.length>0&&$(e.sucursales[0].id))}catch(e){console.error("Error loading sucursales",e)}},X=async(t="",s)=>{y(!0);try{let a=s||e?.sucursal,r=await K.getProductos({search:t,page_size:20,activo:!0,sucursal:a});m(r.results||r.data||[])}catch(e){console.error("Error loading products",e)}finally{y(!1)}},Y=async()=>{if(!F)return alert("Seleccione una sucursal");try{let e=await K.abrirTurno(F);e.success&&(o(e.data),_(!1),X("",F))}catch(e){alert(e.message||"Error al abrir turno")}},ee=async()=>{A(!0)},et=async e=>{try{await K.cerrarTurno(e),o(null),h([]),f({identificacion:"9999999999",razon_social:"CONSUMIDOR FINAL",email:"",direccion:""}),await Q(),_(!0)}catch(e){throw alert(e.message||"Error al cerrar turno"),e}};(0,s.useRef)(!1);let[es,ea]=(0,s.useState)(!1),[er,el]=(0,s.useState)(null),[ei,eo]=(0,s.useState)([]),[en,ed]=(0,s.useState)(null),ec=async(e,t)=>{try{let s=(await K.getPresentaciones(t.producto.id)).data||[];s.length>0&&(el(t.producto),eo(s),ed(e),ea(!0))}catch(e){console.error(e)}},ex=async e=>{if(ed(null),(e.stock??0)<=0)return void alert("Producto agotado");try{let t=(await K.getPresentaciones(e.id)).data||[];if(0===t.length)return void alert("Este producto no tiene presentaciones/precios definidos");1===t.length?eu(e,t[0]):(el(e),eo(t),ea(!0))}catch(e){console.error(e),alert("Error obteniendo precios del producto")}},eu=(e,t)=>{let s=e.stock??0;h(a=>{let r=a.filter((t,s)=>t.producto.id===e.id&&s!==en).reduce((e,t)=>e+t.cantidad*t.presentacion.cantidad,0),l=1;if(null!==en&&a[en]&&(l=a[en].cantidad),r+l*t.cantidad>s)return alert(`No hay stock suficiente para esta presentaci\xf3n. Max disponible: ${s-r} unidades.`),a;if(null!==en){let e=[...a],s=Number(t.precio);return e[en]={...e[en],presentacion:t,precio:s,subtotal:l*s,total:l*s},e}{let s=a.findIndex(s=>s.producto.id===e.id&&s.presentacion.id===t.id);if(s>=0){let e=[...a],r=e[s],l=r.cantidad+1,i=Number(t.precio);return e[s]={...r,cantidad:l,subtotal:l*i,total:l*i},e}let r=Number(t.precio);return[...a,{producto:e,presentacion:t,cantidad:1,precio:r,subtotal:r,impuesto:0,total:r}]}}),ea(!1),el(null),ed(null),T({message:`Actualizado: ${e.nombre}`,visible:!0}),setTimeout(()=>T(e=>({...e,visible:!1})),2e3)},em=()=>b.reduce((e,t)=>(e.subtotal+=t.subtotal,e.total+=t.total,e.impuesto+=t.impuesto,e),{subtotal:0,total:0,impuesto:0}),[eb,eh]=(0,s.useState)(!1),[eg,ef]=(0,s.useState)([]),[ep,ej]=(0,s.useState)("01"),[ev,ey]=(0,s.useState)(""),eN=()=>{if(0!==b.length){if(em().total>50&&"9999999999"===g.identificacion){alert("Para ventas mayores a $50, debe ingresar los datos del cliente (FacturaciÃ³n ElectrÃ³nica)."),R(!0);return}ey(em().total.toFixed(2)),ef([]),ej("01"),O("9999999999"===g.identificacion),eh(!0)}},ew=async()=>{w(!0);try{let e=eg.reduce((e,t)=>e+t.total,0);if(e<eC.total-.01){alert(`Falta pagar $${(eC.total-e).toFixed(2)}`),w(!1);return}let t={cliente:g,items:b.map(e=>({id:e.producto.id,presentacion_id:e.presentacion.id,cantidad:e.cantidad,precio:e.precio})),pagos:eg,es_interno:z},s=await K.crearFacturaPOS(t);alert(`Venta registrada.
Factura: ${s.numero_autorizacion}
Clave Acceso: ${s.clave_acceso}`),eh(!1),h([]),f({identificacion:"9999999999",razon_social:"CONSUMIDOR FINAL",email:"",direccion:""}),X(p)}catch(e){alert(e?.errorMessage||e?.message||"Error al procesar venta")}finally{w(!1)}},eC=em();if(n)return(0,t.jsx)(a.default,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Verificando turno..."})})});let ek=async e=>{if(M(e),!(e.length<3)){B(!0);try{let t=await K.getClientes({search:e});U(t.results||t.data||[])}catch(e){console.error(e)}finally{B(!1)}}},eS=e=>{let t=e.data||e.results||e;t.identificacion||t.razon_social||console.warn("Posible objeto cliente invÃ¡lido recibido:",e),f(t),R(!1),M(""),U([]),q(!1)},e_=async()=>{if(!G.identificacion||!G.razon_social||!G.email)return void alert("Complete los campos obligatorios (*)");try{let e=await K.crearCliente(G),t=e.data||e;eS(t),alert(`Cliente creado y seleccionado: ${t.razon_social}`)}catch(t){console.error("Error creating client:",t);let e=t.data?JSON.stringify(t.data,null,2):t.message;alert(`Error al crear cliente (${t.status||"N/A"}):
${e}`)}};return(0,t.jsxs)(a.default,{children:[(0,t.jsxs)("div",{className:"flex flex-col h-[calc(100vh-64px)] overflow-hidden bg-gray-100",children:[e&&(0,t.jsxs)("div",{className:"bg-indigo-900 text-white px-4 py-2 flex justify-between items-center text-sm shadow-md z-10 shrink-0",children:[(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Sucursal:"})," ",e.sucursal_nombre]}),(0,t.jsx)("span",{className:"hidden md:inline",children:"|"}),(0,t.jsxs)("span",{className:"hidden md:inline",children:[(0,t.jsx)("strong",{children:"Inicio:"})," ",new Date(e.inicio_turno).toLocaleString()]})]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{onClick:ee,className:"bg-red-500 hover:bg-red-600 px-3 py-1 rounded text-xs font-bold transition-colors",children:"Cerrar Turno / Cambiar Sucursal"})})]}),(0,t.jsxs)("div",{className:"md:hidden flex bg-white border-b shrink-0",children:[(0,t.jsx)("button",{onClick:()=>k("catalog"),className:`flex-1 py-3 text-sm font-bold ${"catalog"===C?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"}`,children:"CatÃ¡logo"}),(0,t.jsxs)("button",{onClick:()=>k("cart"),className:`flex-1 py-3 text-sm font-bold ${"cart"===C?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"}`,children:["Carrito (",b.reduce((e,t)=>e+t.cantidad,0),")"]})]}),(0,t.jsx)("div",{className:"flex-1 flex overflow-hidden",children:e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:`flex-1 flex flex-col p-4 bg-gray-50 md:flex ${"cart"===C?"hidden":"block"}`,children:[(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("input",{ref:Z,type:"text",placeholder:"Buscar producto (CÃ³digo o Nombre) - F2",className:"w-full p-3 border rounded-lg shadow-sm text-lg focus:ring-2 focus:ring-blue-500 outline-none",value:p,onChange:e=>{j(e.target.value),X(e.target.value)}})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 content-start pb-20",children:v?(0,t.jsx)("div",{className:"col-span-full text-center py-10",children:"Cargando productos..."}):u.map(e=>{let s=e.stock??0,a=s>0;return(0,t.jsxs)("div",{onClick:()=>{a&&(ex(e),T({message:`Agregado: ${e.nombre}`,visible:!0}),setTimeout(()=>T(e=>({...e,visible:!1})),2e3))},className:`
                          relative p-4 rounded-xl shadow-sm transition-all flex flex-col justify-between h-40 border
                          active:scale-95 duration-75
                          ${a?"bg-white hover:shadow-md cursor-pointer border-transparent hover:border-blue-300":"bg-gray-100 cursor-not-allowed border-gray-200 opacity-70"}
                        `,children:[!a&&(0,t.jsx)("div",{className:"absolute top-2 right-2 bg-red-100 text-red-600 text-xs font-bold px-2 py-1 rounded-full z-10",children:"AGOTADO"}),a&&s<=5&&(0,t.jsxs)("div",{className:"absolute top-2 right-2 bg-orange-100 text-orange-600 text-xs font-bold px-2 py-1 rounded-full z-10",children:[s," left"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.codigo_producto||"S/C"}),(0,t.jsx)("h3",{className:"font-semibold text-gray-800 line-clamp-2 leading-tight",children:e.nombre})]}),(0,t.jsxs)("div",{className:"mt-2 flex justify-between items-end",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Stock: ",(0,t.jsx)("span",{className:a?"text-gray-700":"text-red-500",children:Number(s).toString()})]}),(0,t.jsx)("span",{className:"text-lg font-bold text-blue-600 block",children:"$ -"})]})]},e.id)})})]}),(0,t.jsxs)("div",{className:`w-full md:w-[400px] flex flex-col bg-white shadow-xl md:flex ${"catalog"===C?"hidden":"block"}`,children:[(0,t.jsxs)("div",{className:"p-4 border-b bg-gray-50",children:[(0,t.jsx)("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Cliente (F10)"}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-bold text-gray-800",children:g.razon_social}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:g.identificacion})]}),(0,t.jsx)("button",{onClick:()=>R(!0),className:"text-blue-600 hover:bg-blue-50 p-2 rounded text-sm font-semibold",children:"Cambiar"})]})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:[0===b.length&&(0,t.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 text-center p-4",children:[(0,t.jsx)("span",{className:"block text-4xl mb-2",children:"ðŸ›’"}),(0,t.jsx)("span",{children:"Carrito vacÃ­o"})]}),b.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg group cursor-pointer hover:bg-blue-50 transition-colors border border-transparent hover:border-blue-200",onClick:()=>ec(s,e),title:"Click para cambiar presentaciÃ³n",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium text-gray-800",children:e.producto.nombre}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.presentacion.nombre_presentacion}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("span",{className:"font-bold",children:e.cantidad})," x $",e.precio.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"font-bold text-gray-800",children:["$",e.total.toFixed(2)]}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),h(e=>e.filter((e,t)=>t!==s))},className:"text-red-400 hover:text-red-600 text-xs mt-1 p-1",children:"Eliminar"})]})]},s))]}),(0,t.jsxs)("div",{className:"p-4 border-t bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,t.jsx)("span",{children:"Subtotal"}),(0,t.jsxs)("span",{children:["$",eC.subtotal.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-3",children:[(0,t.jsx)("span",{children:"IVA"}),(0,t.jsxs)("span",{children:["$",eC.impuesto.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-2xl font-bold text-gray-800 mb-4",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{children:["$",eC.total.toFixed(2)]})]}),(0,t.jsx)("button",{onClick:eN,disabled:0===b.length||N,className:"w-full bg-blue-600 text-white py-4 rounded-xl text-lg font-bold hover:bg-blue-700 disabled:opacity-50 shadow-lg shadow-blue-200",children:N?"Procesando...":"COBRAR (F9)"})]})]})]}):(0,t.jsx)("div",{className:"flex-1 flex flex-col items-center justify-center bg-gray-50 text-center p-8",children:(0,t.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-xl max-w-md w-full border border-gray-100",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)("span",{className:"text-4xl",children:"ðŸª"})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Caja Cerrada"}),(0,t.jsx)("p",{className:"text-gray-500 mb-8",children:"No tienes un turno activo en este momento. Para comenzar a realizar ventas, debes abrir un turno en una sucursal."}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{onClick:()=>{Q(),_(!0)},className:"w-full bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-indigo-700 shadow-lg shadow-indigo-200 transition-all transform hover:-translate-y-0.5",children:"Abrir Turno"}),(0,t.jsx)("button",{onClick:()=>window.history.back(),className:"w-full text-gray-500 hover:text-gray-700 font-medium text-sm",children:"Volver al Dashboard"})]})]})})}),E.visible&&(0,t.jsxs)("div",{className:"fixed bottom-20 md:bottom-10 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-6 py-3 rounded-full shadow-2xl z-50 flex items-center animate-fade-in-up",children:[(0,t.jsx)("span",{className:"text-xl mr-2",children:"âœ…"}),(0,t.jsx)("span",{className:"font-semibold",children:E.message})]}),(0,t.jsx)(l.default,{isOpen:eb,onClose:()=>eh(!1),children:(0,t.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 max-w-lg w-full",children:[(0,t.jsxs)("div",{className:"border-b pb-4 mb-4",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Procesar Pago"}),(0,t.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Total a Pagar:"}),(0,t.jsxs)("span",{className:"text-2xl font-bold text-gray-900",children:["$",eC.total.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"mb-4 p-3 bg-indigo-50 border border-indigo-100 rounded-lg flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-bold text-indigo-900",children:"Tipo de Documento"}),(0,t.jsx)("div",{className:"text-xs text-indigo-700",children:z?"Nota de Venta (Solo Interno)":"Factura ElectrÃ³nica (SRI)"})]}),(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:!z,onChange:e=>O(!e.target.checked)}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"})]})]}),(0,t.jsxs)("div",{className:"mb-4 bg-gray-50 rounded-lg p-3 max-h-40 overflow-y-auto",children:[(0,t.jsx)("div",{className:"text-xs font-bold text-gray-500 mb-2 uppercase",children:"Pagos Agregados"}),0===eg.length&&(0,t.jsx)("div",{className:"text-sm text-gray-400 italic",children:"No hay pagos agregados"}),eg.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b last:border-0",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold text-gray-800",children:e.descripcion}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.codigo})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"font-bold",children:["$",e.total.toFixed(2)]}),(0,t.jsx)("button",{onClick:()=>{ef(e=>e.filter((e,t)=>t!==s))},className:"text-red-500 hover:text-red-700",children:"âœ•"})]})]},s))]}),(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"MÃ©todo"}),(0,t.jsxs)("select",{className:"w-full p-2 border rounded text-sm",value:ep,onChange:e=>ej(e.target.value),children:[(0,t.jsx)("option",{value:"01",children:"Efectivo (Sin Sist. Financiero)"}),(0,t.jsx)("option",{value:"19",children:"Tarjeta de CrÃ©dito"}),(0,t.jsx)("option",{value:"16",children:"Tarjeta de DÃ©bito"}),(0,t.jsx)("option",{value:"20",children:"Transferencia / Otros con SF"}),(0,t.jsx)("option",{value:"17",children:"Dinero ElectrÃ³nico"}),(0,t.jsx)("option",{value:"18",children:"Tarjeta Prepago"}),(0,t.jsx)("option",{value:"15",children:"CompensaciÃ³n de Deudas"}),(0,t.jsx)("option",{value:"21",children:"Endoso de TÃ­tulos"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Monto"}),(0,t.jsx)("input",{type:"number",step:"0.01",className:"w-full p-2 border rounded text-sm",value:ev,onChange:e=>ey(e.target.value)})]})]}),(0,t.jsx)("button",{onClick:()=>{let e=parseFloat(ev);if(isNaN(e)||e<=0)return alert("Monto invÃ¡lido");let t={"01":"Efectivo",19:"Tarjeta de CrÃ©dito",16:"Tarjeta de DÃ©bito",20:"Transferencia / Otros",17:"Dinero ElectrÃ³nico",18:"Tarjeta Prepago",15:"CompensaciÃ³n de Deudas",21:"Endoso de TÃ­tulos"}[ep]||"Otro";ef(s=>[...s,{codigo:ep,descripcion:t,total:e}]);let s=eg.reduce((e,t)=>e+t.total,0)+e;ey(Math.max(0,eC.total-s).toFixed(2))},className:"w-full bg-blue-600 text-white py-2 rounded font-bold hover:bg-blue-700 text-sm",children:"+ Agregar Pago"})]}),(0,t.jsxs)("div",{className:"border-t pt-4",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-4 text-lg",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Total Pagado:"}),(0,t.jsxs)("span",{className:`font-bold ${eg.reduce((e,t)=>e+t.total,0)>=eC.total?"text-green-600":"text-red-600"}`,children:["$",eg.reduce((e,t)=>e+t.total,0).toFixed(2)]})]}),eg.reduce((e,t)=>e+t.total,0)>=eC.total&&(0,t.jsxs)("div",{className:"flex justify-between mb-4 text-sm text-gray-500 bg-green-50 p-2 rounded",children:[(0,t.jsx)("span",{children:"Cambio / Vuelto:"}),(0,t.jsxs)("span",{className:"font-bold text-green-700",children:["$",(eg.reduce((e,t)=>e+t.total,0)-eC.total).toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>eh(!1),className:"flex-1 py-3 border border-gray-300 rounded-xl font-bold text-gray-600 hover:bg-gray-50",children:"Cancelar"}),(0,t.jsx)("button",{onClick:ew,disabled:N||eg.reduce((e,t)=>e+t.total,0)<eC.total-.01,className:"flex-1 py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 disabled:opacity-50 shadow-lg shadow-green-200",children:N?"Procesando...":"FINALIZAR VENTA ðŸš€"})]})]})]})}),(0,t.jsx)(l.default,{isOpen:es,onClose:()=>ea(!1),children:(0,t.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 max-w-lg w-full rounded-2xl",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:null!==en?"Cambiar PresentaciÃ³n":"Seleccionar PresentaciÃ³n"}),(0,t.jsxs)("p",{className:"text-gray-500 mb-4 text-sm",children:["Producto: ",(0,t.jsx)("span",{className:"font-bold text-gray-800",children:er?.nombre})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-3 max-h-[60vh] overflow-y-auto",children:ei.map(e=>(0,t.jsxs)("button",{onClick:()=>er&&eu(er,e),className:"flex justify-between items-center p-4 border rounded-xl hover:bg-blue-50 hover:border-blue-300 transition-all text-left",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-bold text-gray-800",children:e.nombre_presentacion}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Contiene: ",e.cantidad," unidades"]})]}),(0,t.jsxs)("div",{className:"text-lg font-bold text-blue-600",children:["$",e.precio]})]},e.id))}),(0,t.jsx)("div",{className:"mt-4 text-right",children:(0,t.jsx)("button",{onClick:()=>ea(!1),className:"px-4 py-2 text-gray-500 hover:text-gray-700 font-medium",children:"Cancelar"})})]})}),(0,t.jsx)(l.default,{isOpen:S,onClose:()=>_(!1),children:(0,t.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900 mb-2",children:"Iniciar Turno de Caja"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Para realizar ventas, primero debes abrir un turno en una sucursal."}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seleccionar Sucursal"}),(0,t.jsx)("select",{className:"w-full p-2 border rounded",value:F||"",onChange:e=>$(Number(e.target.value)),children:c.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre},e.id))})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4",children:(0,t.jsx)("button",{onClick:Y,disabled:!F,className:"bg-green-600 text-white px-6 py-2 rounded font-bold hover:bg-green-700 disabled:opacity-50",children:"Abrir Turno"})})]})}),(0,t.jsx)(l.default,{isOpen:D,onClose:()=>R(!1),children:(0,t.jsxs)("div",{className:"bg-white w-full max-w-2xl mx-auto rounded-lg shadow-xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b bg-gray-50 flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:W?"Nuevo Cliente":"Buscar Cliente"}),!W&&(0,t.jsx)("button",{onClick:()=>q(!0),className:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded hover:bg-blue-200 font-medium",children:"+ Crear Nuevo"}),W&&(0,t.jsx)("button",{onClick:()=>q(!1),className:"text-sm text-gray-500 hover:text-gray-700",children:"Cancelar"})]}),(0,t.jsx)("div",{className:"p-6",children:W?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo IndentificaciÃ³n *"}),(0,t.jsxs)("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border",value:G.tipo_identificacion,onChange:e=>H({...G,tipo_identificacion:e.target.value}),children:[(0,t.jsx)("option",{value:"05",children:"CÃ©dula"}),(0,t.jsx)("option",{value:"04",children:"RUC"}),(0,t.jsx)("option",{value:"06",children:"Pasaporte"}),(0,t.jsx)("option",{value:"07",children:"Consumidor Final"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"IdentificaciÃ³n *"}),(0,t.jsx)("input",{autoFocus:!0,type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border",value:G.identificacion,onChange:e=>H({...G,identificacion:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"RazÃ³n Social *"}),(0,t.jsx)("input",{type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border",value:G.razon_social,onChange:e=>H({...G,razon_social:e.target.value})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email * (Para Factura ElectrÃ³nica)"}),(0,t.jsx)("input",{type:"email",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border",value:G.email,onChange:e=>H({...G,email:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"TelÃ©fono"}),(0,t.jsx)("input",{type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border",value:G.telefono||"",onChange:e=>H({...G,telefono:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"DirecciÃ³n"}),(0,t.jsx)("input",{type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border",value:G.direccion,onChange:e=>H({...G,direccion:e.target.value})})]})]}),(0,t.jsxs)("div",{className:"pt-4 flex justify-end gap-3",children:[(0,t.jsx)("button",{onClick:()=>q(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Volver"}),(0,t.jsx)("button",{onClick:e_,className:"px-4 py-2 bg-blue-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-blue-700",children:"Guardar y Seleccionar"})]})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("input",{autoFocus:!0,type:"text",className:"w-full p-3 border rounded-lg shadow-sm text-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Escribe cÃ©dula, RUC o nombre...",value:I,onChange:e=>ek(e.target.value)}),(0,t.jsxs)("div",{className:"max-h-60 overflow-y-auto border rounded-md",children:[V&&(0,t.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Buscando..."}),!V&&0===L.length&&I.length>2&&(0,t.jsxs)("div",{className:"p-4 text-center text-gray-500",children:["No se encontraron clientes.",(0,t.jsx)("button",{onClick:()=>{H(e=>({...e,identificacion:I})),q(!0)},className:"text-blue-600 font-bold ml-1 hover:underline",children:"Crear nuevo"})]}),L.map(e=>(0,t.jsxs)("div",{onClick:()=>eS(e),className:"p-3 hover:bg-indigo-50 cursor-pointer border-b last:border-b-0 flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-bold text-gray-800",children:e.razon_social}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:[e.identificacion," â€¢ ",e.email]})]}),(0,t.jsx)("span",{className:"text-indigo-600 text-sm font-medium",children:"Seleccionar"})]},e.id))]}),(0,t.jsx)("div",{className:"flex justify-between items-center pt-2",children:(0,t.jsx)("button",{onClick:()=>eS({id:void 0,identificacion:"9999999999",razon_social:"CONSUMIDOR FINAL",email:"",direccion:""}),className:"text-sm text-gray-500 hover:text-gray-700 underline",children:"Usar Consumidor Final"})})]})})]})})]}),(0,t.jsx)(i,{isOpen:P,onClose:()=>A(!1),onConfirm:et})]})}e.s(["default",()=>o],42366)}]);