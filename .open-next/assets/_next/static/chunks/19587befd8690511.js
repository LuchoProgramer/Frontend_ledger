(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15788,e=>{"use strict";let t=(0,e.i(75254).default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["Truck",()=>t],15788)},18566,(e,t,a)=>{t.exports=e.r(76562)},75254,e=>{"use strict";var t=e.i(71645);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},r=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)(({color:e="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:o="",children:n,iconNode:d,...c},m)=>(0,t.createElement)("svg",{ref:m,...s,width:a,height:a,stroke:e,strokeWidth:l?24*Number(i)/Number(a):i,className:r("lucide",o),...!n&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,a])=>(0,t.createElement)(e,a)),...Array.isArray(n)?n:[n]])),l=(e,s)=>{let l=(0,t.forwardRef)(({className:l,...o},n)=>(0,t.createElement)(i,{ref:n,iconNode:s,className:r(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,l),...o}));return l.displayName=a(e),l};e.s(["default",()=>l],75254)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},36786,e=>{"use strict";var t=e.i(18050),a=e.i(71645),r=e.i(74080);function s({children:e,isOpen:s,onClose:i}){let[l,o]=(0,a.useState)(!1);return((0,a.useEffect)(()=>(o(!0),()=>o(!1)),[]),(0,a.useEffect)(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),l&&s)?(0,r.createPortal)((0,t.jsx)("div",{className:"fixed inset-0 z-[99999] overflow-y-auto",role:"dialog","aria-modal":"true",children:(0,t.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,t.jsx)("div",{className:"fixed inset-0 transition-opacity bg-gray-900/50 backdrop-blur-sm","aria-hidden":"true",onClick:i}),(0,t.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,t.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full relative z-[10000]",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 pt-4 pr-4 block",children:(0,t.jsxs)("button",{type:"button",className:"bg-white rounded-md text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:i,children:[(0,t.jsx)("span",{className:"sr-only",children:"Cerrar"}),(0,t.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})]})}),e]})]})}),document.body):null}e.s(["default",()=>s])},63059,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],63059)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},805,e=>{"use strict";var t=e.i(18050),a=e.i(71645),r=e.i(83639),s=e.i(9165),i=e.i(63059),l=e.i(64659),o=e.i(7233),n=e.i(75254);let d=(0,n.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),c=(0,n.default)("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),m=(0,n.default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),u=(0,n.default)("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);var x=e.i(36786);function h(){let[e,n]=(0,a.useState)([]),[h,p]=(0,a.useState)(!0),[g,b]=(0,a.useState)({}),[y,f]=(0,a.useState)(!1),[v,j]=(0,a.useState)(null),[w,N]=(0,a.useState)({codigo:"",nombre:"",tipo:"ACTIVO",padre:null,es_cuenta_movimiento:!1}),[k,C]=(0,a.useState)(!1),[_,A]=(0,a.useState)(""),O=(0,s.getApiClient)();(0,a.useEffect)(()=>{S()},[]);let S=async()=>{p(!0);try{let e=await O.getPlanCuentas({page_size:1e3});if(e&&e.results){let t=e.results.sort((e,t)=>e.codigo.localeCompare(t.codigo));n(t);let a={};t.forEach(e=>{e.nivel<=2&&(a[e.id]=!0)}),b(a)}}catch(e){console.error("Error cargando plan de cuentas",e)}finally{p(!1)}},E=(t=null)=>{j(null),N({codigo:"",nombre:"",tipo:t&&e.find(e=>e.id===t)?.tipo||"ACTIVO",padre:t,es_cuenta_movimiento:!0}),f(!0),A("")},z=async e=>{if(window.confirm("¿Estás seguro de eliminar esta cuenta?"))try{await O.eliminarCuentaContable(e),S()}catch(e){alert("Error al eliminar cuenta. Asegúrate de que no tenga movimientos ni hijos.")}},M=async e=>{e.preventDefault(),C(!0),A("");try{v?await O.actualizarCuentaContable(v,w):await O.crearCuentaContable(w),f(!1),S()}catch(e){A(e.message||"Error al guardar")}finally{C(!1)}},P=(a,r=0)=>{let s=e.some(e=>e.padre===a.id),n=g[a.id],x=`${20*r+10}px`;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{className:"hover:bg-gray-50 border-b border-gray-100 last:border-0",children:[(0,t.jsx)("td",{className:"py-2 pr-4 text-sm text-gray-900 whitespace-nowrap",children:(0,t.jsxs)("div",{style:{paddingLeft:x},className:"flex items-center",children:[s?(0,t.jsx)("button",{onClick:()=>{var e;return e=a.id,void b(t=>({...t,[e]:!t[e]}))},className:"mr-1 p-1 hover:bg-gray-200 rounded text-gray-400",children:n?(0,t.jsx)(l.ChevronDown,{size:14}):(0,t.jsx)(i.ChevronRight,{size:14})}):(0,t.jsx)("span",{className:"w-6 inline-block"}),(0,t.jsx)("span",{className:`mr-2 ${a.es_cuenta_movimiento?"text-gray-400":"text-yellow-500"}`,children:a.es_cuenta_movimiento?(0,t.jsx)("div",{className:"w-4"}):n?(0,t.jsx)(u,{size:16}):(0,t.jsx)(m,{size:16})}),(0,t.jsx)("span",{className:a.es_cuenta_movimiento?"":"font-semibold",children:a.codigo})]})}),(0,t.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900",children:(0,t.jsx)("span",{className:a.es_cuenta_movimiento?"":"font-semibold",children:a.nombre})}),(0,t.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500 whitespace-nowrap",children:(0,t.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${"ACTIVO"===a.tipo?"bg-blue-100 text-blue-800":"PASIVO"===a.tipo?"bg-red-100 text-red-800":"PATRIMONIO"===a.tipo?"bg-green-100 text-green-800":"INGRESO"===a.tipo?"bg-emerald-100 text-emerald-800":"bg-orange-100 text-orange-800"}`,children:a.tipo})}),(0,t.jsx)("td",{className:"px-4 py-2 text-right text-sm",children:(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[!a.es_cuenta_movimiento&&(0,t.jsx)("button",{onClick:()=>E(a.id),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Agregar Subcuenta",children:(0,t.jsx)(o.Plus,{size:16})}),(0,t.jsx)("button",{onClick:()=>{j(a.id),N({codigo:a.codigo,nombre:a.nombre,tipo:a.tipo,padre:a.padre,es_cuenta_movimiento:a.es_cuenta_movimiento}),f(!0),A("")},className:"p-1 text-gray-600 hover:bg-gray-100 rounded",title:"Editar",children:(0,t.jsx)(d,{size:16})}),(0,t.jsx)("button",{onClick:()=>z(a.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Eliminar",children:(0,t.jsx)(c,{size:16})})]})})]},a.id),s&&n&&e.filter(e=>e.padre===a.id).map(e=>P(e,r+1))]})},T=e.filter(e=>!e.padre);return(0,t.jsxs)(r.default,{children:[(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Plan de Cuentas"}),(0,t.jsxs)("button",{onClick:()=>E(null),className:"w-full md:w-auto px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 flex items-center justify-center gap-2",children:[(0,t.jsx)(o.Plus,{size:18}),"Nueva Cuenta Raíz"]})]}),(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-x-auto",children:h?(0,t.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Cargando estructura..."}):(0,t.jsxs)("table",{className:"min-w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase w-64",children:"Código"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nombre"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase w-32",children:"Tipo"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase w-32",children:"Acciones"})]})}),(0,t.jsx)("tbody",{children:0===T.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:4,className:"p-8 text-center text-gray-500",children:"No hay cuentas registradas. Comienza creando una cuenta raíz."})}):T.map(e=>P(e))})]})})]}),(0,t.jsx)(x.default,{isOpen:y,onClose:()=>f(!1),children:(0,t.jsxs)("form",{onSubmit:M,className:"w-full max-w-lg bg-white rounded-lg shadow-xl overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:v?"Editar Cuenta":"Nueva Cuenta"})}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[_&&(0,t.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-3 text-red-700 text-sm",children:_}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Código"}),(0,t.jsx)("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",placeholder:"Ej: 1.1.01",value:w.codigo,onChange:e=>N({...w,codigo:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo"}),(0,t.jsxs)("select",{className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",value:w.tipo,onChange:e=>N({...w,tipo:e.target.value}),disabled:!!w.padre&&!v,children:[(0,t.jsx)("option",{value:"ACTIVO",children:"Activo"}),(0,t.jsx)("option",{value:"PASIVO",children:"Pasivo"}),(0,t.jsx)("option",{value:"PATRIMONIO",children:"Patrimonio"}),(0,t.jsx)("option",{value:"INGRESO",children:"Ingreso"}),(0,t.jsx)("option",{value:"GASTO",children:"Gasto"}),(0,t.jsx)("option",{value:"COSTO",children:"Costo"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre"}),(0,t.jsx)("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",placeholder:"Ej: Caja General",value:w.nombre,onChange:e=>N({...w,nombre:e.target.value})})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"es_movimiento",className:"h-4 w-4 text-indigo-600 border-gray-300 rounded",checked:w.es_cuenta_movimiento,onChange:e=>N({...w,es_cuenta_movimiento:e.target.checked})}),(0,t.jsx)("label",{htmlFor:"es_movimiento",className:"ml-2 block text-sm text-gray-900",children:"Acepta movimientos (es cuenta final, no grupo)"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 px-6 py-4 flex justify-end gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",disabled:k,className:"px-4 py-2 bg-indigo-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50",children:k?"Guardando...":"Guardar"})]})]})})]})}e.s(["default",()=>h],805)}]);