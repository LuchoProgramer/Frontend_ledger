(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15788,e=>{"use strict";let t=(0,e.i(75254).default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["Truck",()=>t],15788)},18566,(e,t,a)=>{t.exports=e.r(76562)},75254,e=>{"use strict";var t=e.i(71645);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)(({color:e="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:i="",children:c,iconNode:n,...o},x)=>(0,t.createElement)("svg",{ref:x,...r,width:a,height:a,stroke:e,strokeWidth:d?24*Number(l)/Number(a):l,className:s("lucide",i),...!c&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(o)&&{"aria-hidden":"true"},...o},[...n.map(([e,a])=>(0,t.createElement)(e,a)),...Array.isArray(c)?c:[c]])),d=(e,r)=>{let d=(0,t.forwardRef)(({className:d,...i},c)=>(0,t.createElement)(l,{ref:c,iconNode:r,className:s(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,d),...i}));return d.displayName=a(e),d};e.s(["default",()=>d],75254)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},45365,e=>{"use strict";var t=e.i(18050),a=e.i(71645),s=e.i(83639),r=e.i(9165);function l(){let[e,l]=(0,a.useState)([]),[d,i]=(0,a.useState)(!1),[c,n]=(0,a.useState)(""),[o,x]=(0,a.useState)(""),[m,p]=(0,a.useState)(""),[u,h]=(0,a.useState)([]),[g,y]=(0,a.useState)({total_ventas:0,transacciones:0,ticket_promedio:0}),[w,b]=(0,a.useState)(1),[f,N]=(0,a.useState)(1),j=(0,r.getApiClient)();(0,a.useEffect)(()=>{v(),_(),k()},[w]),(0,a.useEffect)(()=>{k()},[c,o,m,e]);let v=async()=>{try{let e=await j.getSucursalesList({page_size:100});e.results&&h(e.results)}catch(e){console.error(e)}},k=async()=>{try{let e=await j.getResumenGeneral({start_date:c,end_date:o,sucursal_id:m});y(e)}catch(e){console.error(e)}},_=async()=>{i(!0);try{let e=await j.getSalesReport({page:w,start_date:c,end_date:o,sucursal_id:m});l(e.results||[]),e.count&&N(Math.ceil(e.count/20))}catch(e){console.error("Error loading sales",e)}finally{i(!1)}};(0,a.useEffect)(()=>{if(!e.some(e=>"EN_PROCESO"===e.estado||"PPR"===e.estado))return;console.log("Detectado facturas pendientes, activando auto-refresh...");let t=setInterval(()=>{_()},1e4);return()=>clearInterval(t)},[e]);let S=async()=>{try{let e=await j.exportSalesExcel({start_date:c,end_date:o,sucursal_id:m}),t=window.URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`reporte_ventas_${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(t)}catch(e){alert("Error descargando el reporte"),console.error(e)}};return(0,t.jsx)(s.default,{children:(0,t.jsxs)("div",{className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,t.jsx)("h1",{className:"text-xl md:text-2xl font-bold text-gray-800",children:"Reporte Detallado de Ventas"}),(0,t.jsx)("div",{className:"flex gap-2 w-full md:w-auto",children:(0,t.jsx)("button",{onClick:S,className:"bg-green-600 w-full md:w-auto justify-center text-white px-4 py-2 rounded hover:bg-green-700 flex items-center gap-2",children:(0,t.jsx)("span",{children:"Descargar Excel"})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-4",children:[(0,t.jsxs)("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow-sm border-l-4 border-blue-500 col-span-2 md:col-span-1",children:[(0,t.jsx)("div",{className:"text-xs md:text-sm text-gray-500",children:"Total Vendido"}),(0,t.jsxs)("div",{className:"text-xl md:text-2xl font-bold text-gray-800",children:["$",Number(g.total_ventas||0).toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow-sm border-l-4 border-green-500",children:[(0,t.jsx)("div",{className:"text-xs md:text-sm text-gray-500",children:"Transacciones"}),(0,t.jsx)("div",{className:"text-lg md:text-2xl font-bold text-gray-800",children:g.transacciones})]}),(0,t.jsxs)("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow-sm border-l-4 border-purple-500",children:[(0,t.jsx)("div",{className:"text-xs md:text-sm text-gray-500",children:"Ticket Promedio"}),(0,t.jsxs)("div",{className:"text-lg md:text-2xl font-bold text-gray-800",children:["$",Number(g.ticket_promedio||0).toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm flex flex-wrap gap-4 items-end",children:[(0,t.jsxs)("div",{className:"w-full md:w-64",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sucursal"}),(0,t.jsxs)("select",{value:m,onChange:e=>p(e.target.value),className:"p-2 border rounded-md w-full bg-gray-50",children:[(0,t.jsx)("option",{value:"",children:"Todas"}),u.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,t.jsxs)("div",{className:"w-full md:w-auto",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Desde"}),(0,t.jsx)("input",{type:"datetime-local",value:c,onChange:e=>n(e.target.value),className:"p-2 border rounded-md w-full bg-gray-50"})]}),(0,t.jsxs)("div",{className:"w-full md:w-auto",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hasta"}),(0,t.jsx)("input",{type:"datetime-local",value:o,onChange:e=>x(e.target.value),className:"p-2 border rounded-md w-full bg-gray-50"})]}),(0,t.jsx)("button",{onClick:()=>{b(1),_(),k()},className:"bg-indigo-600 text-white px-6 py-2 rounded hover:bg-indigo-700 w-full md:w-auto font-medium shadow-sm transition-colors",children:"Filtrar Reporte"})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-3 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),(0,t.jsx)("th",{className:"px-3 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Factura"}),(0,t.jsx)("th",{className:"px-3 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),(0,t.jsx)("th",{className:"px-3 md:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subtotal"}),(0,t.jsx)("th",{className:"px-3 md:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IVA"}),(0,t.jsx)("th",{className:"px-3 md:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),(0,t.jsx)("th",{className:"px-3 md:px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"})]})}),(0,t.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[d&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,className:"p-4 text-center",children:"Cargando..."})}),!d&&0===e.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"No se encontraron ventas"})}),e.map(e=>{let a;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.fecha_emision).toLocaleDateString()}),(0,t.jsx)("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.numero_autorizacion}),(0,t.jsx)("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.cliente?.razon_social||"Consumidor Final"}),(0,t.jsxs)("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:["$",Number(e.total_sin_impuestos).toFixed(2)]}),(0,t.jsxs)("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:["$",Number(e.valor_iva).toFixed(2)]}),(0,t.jsxs)("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900 text-right",children:["$",Number(e.total_con_impuestos).toFixed(2)]}),(0,t.jsx)("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap text-center",children:(a=({AUTORIZADA:{label:"Autorizada",className:"bg-green-100 text-green-800"},EN_PROCESO:{label:"Pendiente SRI",className:"bg-yellow-100 text-yellow-800"},RECHAZADA:{label:"Rechazada - SRI",className:"bg-red-100 text-red-800"},ANULADA:{label:"Anulada",className:"bg-gray-100 text-gray-800"}})[e.estado]||{label:e.estado,className:"bg-gray-100 text-gray-800"},(0,t.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${a.className}`,children:a.label}))})]},e.id)})]})]})}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("button",{onClick:()=>b(e=>Math.max(1,e-1)),disabled:1===w,className:"px-4 py-2 border rounded disabled:opacity-50",children:"Anterior"}),(0,t.jsxs)("span",{children:["PÃ¡gina ",w," de ",f]}),(0,t.jsx)("button",{onClick:()=>b(e=>Math.min(f,e+1)),disabled:w===f,className:"px-4 py-2 border rounded disabled:opacity-50",children:"Siguiente"})]})]})})}e.s(["default",()=>l])}]);