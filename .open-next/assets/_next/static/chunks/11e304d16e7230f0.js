(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,r,t)=>{r.exports=e.r(76562)},75254,e=>{"use strict";var r=e.i(71645);let t=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},a=(...e)=>e.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim();var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:d,iconNode:c,...n},u)=>(0,r.createElement)("svg",{ref:u,...s,width:t,height:t,stroke:e,strokeWidth:o?24*Number(i)/Number(t):i,className:a("lucide",l),...!d&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(n)&&{"aria-hidden":"true"},...n},[...c.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(d)?d:[d]])),o=(e,s)=>{let o=(0,r.forwardRef)(({className:o,...l},d)=>(0,r.createElement)(i,{ref:d,iconNode:s,className:a(`lucide-${t(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,o),...l}));return o.displayName=t(e),o};e.s(["default",()=>o],75254)},7233,e=>{"use strict";let r=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>r],7233)},63209,e=>{"use strict";let r=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>r],63209)},55436,e=>{"use strict";let r=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>r],55436)},95468,e=>{"use strict";let r=(0,e.i(75254).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>r],95468)},56909,e=>{"use strict";let r=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>r],56909)},51740,e=>{"use strict";var r=e.i(18050),t=e.i(71645),a=e.i(57951),s=e.i(75254);let i=(0,s.default)("arrow-left-right",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);var o=e.i(56909),l=e.i(7233);let d=(0,s.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var c=e.i(55436),n=e.i(63209),u=e.i(95468),m=e.i(18566);function g(){let{api:e}=(0,a.useAuth)(),s=(0,m.useRouter)(),[g,p]=(0,t.useState)(!0),[x,h]=(0,t.useState)(!1),[y,b]=(0,t.useState)([]),[f,j]=(0,t.useState)([]),[v,N]=(0,t.useState)({producto_id:"",sucursal_id:"",tipo:"ENTRADA",cantidad:"",motivo:""}),[k,w]=(0,t.useState)(null);(0,t.useEffect)(()=>{(async()=>{try{let[r,t]=await Promise.all([e.getProductos({page_size:100,activo:!0}),e.getSucursalesList({page_size:50})]);b(r.results||[]),j(t.results||[])}catch(e){w({type:"error",text:"Error cargando datos iniciales."}),console.error(e)}finally{p(!1)}})()},[e]);let A=async r=>{if(r.preventDefault(),h(!0),w(null),!v.producto_id||!v.sucursal_id||!v.cantidad||!v.motivo){w({type:"error",text:"Todos los campos son obligatorios."}),h(!1);return}try{await e.ajusteInventario({producto_id:parseInt(v.producto_id),sucursal_id:parseInt(v.sucursal_id),tipo:v.tipo,cantidad:parseFloat(v.cantidad),motivo:v.motivo}),w({type:"success",text:"Ajuste realizado correctamente."}),N(e=>({...e,cantidad:"",motivo:""}))}catch(e){w({type:"error",text:e.message||"Error al procesar el ajuste."})}finally{h(!1)}};return g?(0,r.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Cargando catálogo..."}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-4 md:p-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[(0,r.jsx)(i,{className:"w-8 h-8 text-indigo-600"}),"Ajustes de Inventario"]}),(0,r.jsx)("p",{className:"text-gray-500 mt-2",children:"Registra entradas o salidas manuales de mercadería para corregir diferencias de stock."})]}),k&&(0,r.jsxs)("div",{className:`mb-6 p-4 rounded-lg flex items-start gap-3 ${"success"===k.type?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:["success"===k.type?(0,r.jsx)(u.CheckCircle2,{className:"w-5 h-5 shrink-0"}):(0,r.jsx)(n.AlertCircle,{className:"w-5 h-5 shrink-0"}),(0,r.jsx)("p",{children:k.text})]}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:(0,r.jsxs)("form",{onSubmit:A,className:"p-6 md:p-8 space-y-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sucursal Afectada"}),(0,r.jsxs)("select",{className:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all",value:v.sucursal_id,onChange:e=>N({...v,sucursal_id:e.target.value}),required:!0,children:[(0,r.jsx)("option",{value:"",children:"Seleccione una sucursal..."}),f.map(e=>(0,r.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Producto"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.Search,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),(0,r.jsxs)("select",{className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all appearance-none",value:v.producto_id,onChange:e=>N({...v,producto_id:e.target.value}),required:!0,children:[(0,r.jsx)("option",{value:"",children:"Buscar producto por nombre o código..."}),y.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.codigo_producto," - ",e.nombre]},e.id))]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Mostrando primeros 100 productos activos."})]})]}),(0,r.jsxs)("div",{className:"space-y-6 bg-gray-50 p-6 rounded-lg border border-gray-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Ajuste"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>N({...v,tipo:"ENTRADA"}),className:`flex items-center justify-center gap-2 py-2 px-4 rounded-lg border font-medium transition-all ${"ENTRADA"===v.tipo?"bg-green-100 border-green-500 text-green-700 ring-2 ring-green-500/20":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:[(0,r.jsx)(l.Plus,{className:"w-4 h-4"})," Entrada (Sobra)"]}),(0,r.jsxs)("button",{type:"button",onClick:()=>N({...v,tipo:"SALIDA"}),className:`flex items-center justify-center gap-2 py-2 px-4 rounded-lg border font-medium transition-all ${"SALIDA"===v.tipo?"bg-red-100 border-red-500 text-red-700 ring-2 ring-red-500/20":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:[(0,r.jsx)(d,{className:"w-4 h-4"})," Salida (Falta)"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cantidad"}),(0,r.jsx)("input",{type:"number",step:"0.01",min:"0.01",placeholder:"0.00",className:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none",value:v.cantidad,onChange:e=>N({...v,cantidad:e.target.value}),required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo / Justificación"}),(0,r.jsx)("textarea",{placeholder:"Explique la razón del ajuste (ej: Conteo corregido, merma, rotura)",className:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none h-24 resize-none",value:v.motivo,onChange:e=>N({...v,motivo:e.target.value}),required:!0})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-4 pt-4 border-t border-gray-100",children:[(0,r.jsx)("button",{type:"button",className:"px-6 py-2 text-gray-600 hover:text-gray-900 font-medium transition-colors",onClick:()=>s.back(),children:"Cancelar"}),(0,r.jsxs)("button",{type:"submit",disabled:x,className:`flex items-center gap-2 bg-indigo-600 text-white px-8 py-2.5 rounded-lg shadow-sm hover:bg-indigo-700 transition-all font-medium ${x?"opacity-70 cursor-not-allowed":""}`,children:[(0,r.jsx)(o.Save,{className:"w-4 h-4"}),x?"Guardando...":"Aplicar Ajuste"]})]})]})})]})}e.s(["default",()=>g],51740)}]);